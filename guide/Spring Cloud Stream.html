<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spring Cloud Stream | 面向对象Coding</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script>
            var _hmt = _hmt || [];
            (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?634681ee52ddf5b1f6ff2c69397bda83";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
            })();
            
            </script>
    <meta name="description" content="oopCoding">
    
    <link rel="preload" href="/vue-press/assets/css/0.styles.a7b48b74.css" as="style"><link rel="preload" href="/vue-press/assets/js/app.8857885a.js" as="script"><link rel="preload" href="/vue-press/assets/js/2.c05b7fa4.js" as="script"><link rel="preload" href="/vue-press/assets/js/38.f4905a78.js" as="script"><link rel="prefetch" href="/vue-press/assets/js/10.c3630bc0.js"><link rel="prefetch" href="/vue-press/assets/js/11.19806737.js"><link rel="prefetch" href="/vue-press/assets/js/12.f01bacfb.js"><link rel="prefetch" href="/vue-press/assets/js/13.69e815f0.js"><link rel="prefetch" href="/vue-press/assets/js/14.0a5e1b2f.js"><link rel="prefetch" href="/vue-press/assets/js/15.6f04d84b.js"><link rel="prefetch" href="/vue-press/assets/js/16.99b7d4e9.js"><link rel="prefetch" href="/vue-press/assets/js/17.5095a14a.js"><link rel="prefetch" href="/vue-press/assets/js/18.acc9c901.js"><link rel="prefetch" href="/vue-press/assets/js/19.ca2d73b4.js"><link rel="prefetch" href="/vue-press/assets/js/20.47c3e77e.js"><link rel="prefetch" href="/vue-press/assets/js/21.dfa37998.js"><link rel="prefetch" href="/vue-press/assets/js/22.201c1c4e.js"><link rel="prefetch" href="/vue-press/assets/js/23.f196e442.js"><link rel="prefetch" href="/vue-press/assets/js/24.b6941784.js"><link rel="prefetch" href="/vue-press/assets/js/25.8c119899.js"><link rel="prefetch" href="/vue-press/assets/js/26.00f7470d.js"><link rel="prefetch" href="/vue-press/assets/js/27.cfb3a0b2.js"><link rel="prefetch" href="/vue-press/assets/js/28.7fdd6be5.js"><link rel="prefetch" href="/vue-press/assets/js/29.c4f336ea.js"><link rel="prefetch" href="/vue-press/assets/js/3.8ea11f8e.js"><link rel="prefetch" href="/vue-press/assets/js/30.4b94204f.js"><link rel="prefetch" href="/vue-press/assets/js/31.7937a76c.js"><link rel="prefetch" href="/vue-press/assets/js/32.356c0006.js"><link rel="prefetch" href="/vue-press/assets/js/33.e33d865a.js"><link rel="prefetch" href="/vue-press/assets/js/34.df71d62e.js"><link rel="prefetch" href="/vue-press/assets/js/35.4226698a.js"><link rel="prefetch" href="/vue-press/assets/js/36.4d01d025.js"><link rel="prefetch" href="/vue-press/assets/js/37.c53a709d.js"><link rel="prefetch" href="/vue-press/assets/js/39.4e952ee6.js"><link rel="prefetch" href="/vue-press/assets/js/4.5a363195.js"><link rel="prefetch" href="/vue-press/assets/js/40.fce62c8f.js"><link rel="prefetch" href="/vue-press/assets/js/41.46c1dfe2.js"><link rel="prefetch" href="/vue-press/assets/js/42.5616e3e3.js"><link rel="prefetch" href="/vue-press/assets/js/43.b9f83c8a.js"><link rel="prefetch" href="/vue-press/assets/js/44.cfe7bf29.js"><link rel="prefetch" href="/vue-press/assets/js/45.dc3f54ba.js"><link rel="prefetch" href="/vue-press/assets/js/46.f063949d.js"><link rel="prefetch" href="/vue-press/assets/js/47.43e45385.js"><link rel="prefetch" href="/vue-press/assets/js/48.299006a2.js"><link rel="prefetch" href="/vue-press/assets/js/49.7cd3afd3.js"><link rel="prefetch" href="/vue-press/assets/js/5.dfff2508.js"><link rel="prefetch" href="/vue-press/assets/js/50.c3c8025f.js"><link rel="prefetch" href="/vue-press/assets/js/51.7d2ddfde.js"><link rel="prefetch" href="/vue-press/assets/js/52.fff13010.js"><link rel="prefetch" href="/vue-press/assets/js/53.f4c30126.js"><link rel="prefetch" href="/vue-press/assets/js/54.66a127d0.js"><link rel="prefetch" href="/vue-press/assets/js/55.aa83320e.js"><link rel="prefetch" href="/vue-press/assets/js/56.36258450.js"><link rel="prefetch" href="/vue-press/assets/js/57.13c74748.js"><link rel="prefetch" href="/vue-press/assets/js/58.477544ce.js"><link rel="prefetch" href="/vue-press/assets/js/59.418b3fb1.js"><link rel="prefetch" href="/vue-press/assets/js/6.efb1059d.js"><link rel="prefetch" href="/vue-press/assets/js/60.cd59e3e3.js"><link rel="prefetch" href="/vue-press/assets/js/61.e3b2f495.js"><link rel="prefetch" href="/vue-press/assets/js/62.cee3df47.js"><link rel="prefetch" href="/vue-press/assets/js/63.240e4da3.js"><link rel="prefetch" href="/vue-press/assets/js/64.386ee013.js"><link rel="prefetch" href="/vue-press/assets/js/65.e9c8b285.js"><link rel="prefetch" href="/vue-press/assets/js/66.4f91bd49.js"><link rel="prefetch" href="/vue-press/assets/js/67.5891e088.js"><link rel="prefetch" href="/vue-press/assets/js/7.fdc9ea19.js"><link rel="prefetch" href="/vue-press/assets/js/8.47da94a6.js"><link rel="prefetch" href="/vue-press/assets/js/9.953ba650.js">
    <link rel="stylesheet" href="/vue-press/assets/css/0.styles.a7b48b74.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vue-press/" class="home-link router-link-active"><!----> <span class="site-name">面向对象Coding</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-press/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/interview/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面试宝典
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/vue-press/wechat/" class="nav-link">
  公号文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工具" class="dropdown-title"><span class="title">后端工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端工具" class="mobile-dropdown-title"><span class="title">后端工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.vuepress.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mvnrepository.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  maven
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工具" class="dropdown-title"><span class="title">前端工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端工具" class="mobile-dropdown-title"><span class="title">前端工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-press/guide/https/www.vuepress.org.html" class="nav-link">
  vuepress
</a></li><li class="dropdown-item"><!----> <a href="https://www.vue.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/changeLog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  changeLog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-press/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/interview/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面试宝典
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/vue-press/wechat/" class="nav-link">
  公号文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工具" class="dropdown-title"><span class="title">后端工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端工具" class="mobile-dropdown-title"><span class="title">后端工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.vuepress.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mvnrepository.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  maven
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工具" class="dropdown-title"><span class="title">前端工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端工具" class="mobile-dropdown-title"><span class="title">前端工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-press/guide/https/www.vuepress.org.html" class="nav-link">
  vuepress
</a></li><li class="dropdown-item"><!----> <a href="https://www.vue.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/changeLog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  changeLog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>高级</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue-press/guide/Apache Dubbo Zookeeper.html" class="sidebar-link">Apache Dubbo Zookeeper</a></li><li><a href="/vue-press/guide/Apache Shiro.html" class="sidebar-link">Apache Shiro</a></li><li><a href="/vue-press/guide/Hibernate.html" class="sidebar-link">Hibernate</a></li><li><a href="/vue-press/guide/JDBCTemplate.html" class="sidebar-link">JDBCTemplate</a></li><li><a href="/vue-press/guide/JPA.html" class="sidebar-link">JPA</a></li><li><a href="/vue-press/guide/Mybatis.html" class="sidebar-link">Mybatis</a></li><li><a href="/vue-press/guide/Mysql比知必会.html" class="sidebar-link">Mysql必知必会</a></li><li><a href="/vue-press/guide/Redis.html" class="sidebar-link">Redis</a></li><li><a href="/vue-press/guide/Spring.html" class="sidebar-link">Spring</a></li><li><a href="/vue-press/guide/Spring Boot.html" class="sidebar-link">Spring Boot</a></li><li><a href="/vue-press/guide/Spring Boot整合其他组件.html" class="sidebar-link">Spring Boot整合其他组件</a></li><li><a href="/vue-press/guide/Spring Cloud.html" class="sidebar-link">Spring Cloud Netfilx</a></li><li><a href="/vue-press/guide/Spring Cloud Alibaba.html" class="sidebar-link">Spring Cloud Alibaba</a></li><li><a href="/vue-press/guide/Spring Cloud Stream.html" class="active sidebar-link">Spring Cloud Stream</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#基本概念" class="sidebar-link">基本概念</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#消息中间件应用场景" class="sidebar-link">消息中间件应用场景</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#应用解耦" class="sidebar-link">应用解耦</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#异步处理" class="sidebar-link">异步处理</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#流量削峰" class="sidebar-link">流量削峰</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#日志处理" class="sidebar-link">日志处理</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#核心概念" class="sidebar-link">核心概念</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#工作原理" class="sidebar-link">工作原理</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#实例" class="sidebar-link">实例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#依赖" class="sidebar-link">依赖</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#生产者" class="sidebar-link">生产者</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#消费者" class="sidebar-link">消费者</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#消息分组" class="sidebar-link">消息分组</a></li><li class="sidebar-sub-header"><a href="/vue-press/guide/Spring Cloud Stream.html#消息分区" class="sidebar-link">消息分区</a></li></ul></li><li><a href="/vue-press/guide/Spring Data.html" class="sidebar-link">Spring Data</a></li><li><a href="/vue-press/guide/Spring MVC.html" class="sidebar-link">Spring MVC</a></li><li><a href="/vue-press/guide/Spring Security.html" class="sidebar-link">Spring Security</a></li><li><a href="/vue-press/guide/Spring 注解.html" class="sidebar-link">Spring注解</a></li><li><a href="/vue-press/guide/tkmybatis.html" class="sidebar-link">tkmybatis</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发记录问题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>持续集成</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目篇</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="spring-cloud-stream"><a href="#spring-cloud-stream" class="header-anchor">#</a> Spring Cloud Stream</h1> <h2 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h2> <p>在实际的开发过程中，服务与服务之间经常会使用到消息中间件，用于解决应用解耦 ，异步处理，流量削峰等问题实现高性能，高可用，最终一致性的架构。</p> <p>Spring Cloud Stream是一个用来为微服务应用构建消息驱动能力的框架。它可以基于Spring Boot来创建独立的、可用于生产的Spring应用程序。它通过使用Spring Integration来连接消息代理中间件以实现消息事件驱动的微服务应用。使用Stream可以降低中间件与我们系统之间的 耦合性，不如我们可以让rabbitMq切换为Kafka,可以不用修改代码。只需要修改一些配置即可。</p> <ul><li>独立地构建、测试和部署以数据为中心的应用程序</li> <li>应用现代微服务体系结构模式，包括通过消息传递进行组合</li> <li>使用以事件为中心的思想来分离应用程序职责。事件可以表示在时间上已经发生的事情，下游消费者应用程序可以对此作出反应，而不必知道事件的起源或生产者的身份。</li> <li>将业务逻辑移植到消息代理上(比如 RabbitMQ、 Apache Kafka、 Amazon kinesis)。</li> <li>依赖于框架对常见用例的自动内容类型支持。扩展到不同的数据转换类型是可能的。</li></ul> <h2 id="消息中间件应用场景"><a href="#消息中间件应用场景" class="header-anchor">#</a> 消息中间件应用场景</h2> <h3 id="应用解耦"><a href="#应用解耦" class="header-anchor">#</a> 应用解耦</h3> <p>假设有上百个系统都需要系统A的核心数据，此时负责系统A的工程师将是崩溃的，一旦有系统加入，A系统就需要修改代码，将数据发送到新加入的系统。反之，如果有系统不再需要A发送数据，那么A系统又得修改代码不再向其发送数据。这样的架构设计耦合度太高了，我们就可以引入消息中间件来实现系统之间的解耦。即核心系统A生产核心数据，然后将核心数据发送到消息中间件，下游消费系统根据自身需求从中间件里获取消息进行消费，当不再需要数据时就不取消息进即可，这样系统之间耦合度就大大降低了。具体流程图如下。</p> <p><a href="https://imgtu.com/i/48Ysx0" target="_blank" rel="noopener noreferrer"><img alt="48Ysx0.png" data-src="https://z3.ax1x.com/2021/09/19/48Ysx0.png" loading="lazy" class="lazy"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="异步处理"><a href="#异步处理" class="header-anchor">#</a> 异步处理</h3> <p>比如在电商网站用户下单，下单完成后会给用户进行发送短信或者邮件，而这个发送短信和邮件过程不属于核心业务所以我们可以将其放到其他服务中，我们将原来的流式形式改为中间件模式</p> <p><a href="https://imgtu.com/i/48tokQ" target="_blank" rel="noopener noreferrer"><img alt="48tokQ.png" data-src="https://z3.ax1x.com/2021/09/19/48tokQ.png" loading="lazy" class="lazy"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="流量削峰"><a href="#流量削峰" class="header-anchor">#</a> 流量削峰</h3> <p>比如秒杀服务，一下子进入许多需求针对这个场景我们可以将其中间加入一层消息队列，将请求的先入队列，然后再把队列中的请求平滑的推送给服务，或者让服务去队列中进行拉去。</p> <h3 id="日志处理"><a href="#日志处理" class="header-anchor">#</a> 日志处理</h3> <p>对于小型项目来说，我们通常对日志的处理没有那么多要求，但当用户量达到一定的峰值后，问题便会出现。这式可以用Kafka进行对日志的的处理。</p> <h2 id="核心概念"><a href="#核心概念" class="header-anchor">#</a> 核心概念</h2> <p><a href="https://imgtu.com/i/48d1j1" target="_blank" rel="noopener noreferrer"><img alt="48d1j1.png" data-src="https://z3.ax1x.com/2021/09/19/48d1j1.png" loading="lazy" class="lazy"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <table><thead><tr><th>组成</th> <th>描述</th></tr></thead> <tbody><tr><td>Middleware</td> <td>中间件支持RabbitMQ和Kafka</td></tr> <tr><td>Binder</td> <td>目标绑定器，目标指的是Kafka或者RabbitMq，绑定器就是封装了目标中间件的包，如果操作的是Kafka就是使用spring-cloud-stream-binder-kafka,如果操作是rabbitMq就是使用spring-sttream-binder-rabbit</td></tr> <tr><td>@input</td> <td>注解标识 输入通道，接收（消息消费者）的消息，将通过该通道进入应用程序。</td></tr> <tr><td>@output</td> <td>注解标识输出通道，发布（消息产生者）的消息，将通过该通道离开应用程序</td></tr> <tr><td>@StreamListener</td> <td>监听队列，消费者的队列的消息接收 和@Input一起使用</td></tr> <tr><td>@EnableBinding</td> <td>注解标识绑定，将信道channel和交换机exchange绑定一起</td></tr></tbody></table> <h2 id="工作原理"><a href="#工作原理" class="header-anchor">#</a> 工作原理</h2> <p>通过定义绑定器作为中间层，实现应用程序与消息中间件细节的隔离，通过项应用程序暴漏统一的channel通道，使得应用程序不再考虑各种的消息中间件的实现，当需要升级消息中间件，或者使用更换其他的中间的产品时，我们需要做的就是更换对应的Binder绑定器而不需要修改其他的逻辑</p> <p><a href="https://imgtu.com/i/4GCjMV" target="_blank" rel="noopener noreferrer"><img alt="4GCjMV.png" data-src="https://z3.ax1x.com/2021/09/20/4GCjMV.png" loading="lazy" class="lazy"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>Source: 当需要发送消息时，我们就 可以通过Source.java，他会 把我们所需要发送的消息进行序列化，然后将这些书籍发送到channel中</li> <li>Sink：放我们需要监听消息时，就需要通过Sink.java，它负责从消息通道中获取消息，并将消息反序列化成消息对应的格式，然后交给具体的 监听处理</li> <li>Channel ：通常我们向消息中间件发送消息或者 监听  消息时需要指定主题（topic）和消息队列名称，一旦我们需要变更主题的时候就需要修改消息发送或者消息监听的代码，通过channel对象配置哪个主题，这样变更主题时候就不同更改代码，从而实现中间 件的解耦</li> <li>Binder：通过不同的Binder可以实现与不同的消息中间件整合，Binder提供统一的消息收发接口，从而使得我们可以根据实际需要部署不同的消息中间件，或者根据实际生产中所部署的消息中间件来调整我们的配置。</li></ul> <h2 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h2> <h3 id="依赖"><a href="#依赖" class="header-anchor">#</a> <strong>依赖</strong></h3> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-stream-rabbit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="生产者"><a href="#生产者" class="header-anchor">#</a> 生产者</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.126.128
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> rabbit
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">virtual-host</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
  	<span class="token key atrule">stream</span><span class="token punctuation">:</span>
  	  <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
  	  	<span class="token comment"># 消息发送通道，同样也可以自定义配置通道</span>
		<span class="token key atrule">output</span><span class="token punctuation">:</span>
		  <span class="token key atrule">destination</span><span class="token punctuation">:</span> stream.message <span class="token comment"># 绑定的交换机的名称</span>
		<span class="token comment"># 自定义通道的名称 </span>
		<span class="token key atrule">authorityOutput</span><span class="token punctuation">:</span> 
		  <span class="token key atrule">destination</span><span class="token punctuation">:</span> stream.authority <span class="token comment"># 绑定的交换机的名称</span>
</code></pre></div><p>自定义配置发送通道接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AuthoritySource</span><span class="token punctuation">{</span>
	<span class="token class-name">String</span> AUHORITY_OUTPUT <span class="token operator">=</span> <span class="token string">&quot;authorityOutput&quot;</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Output</span><span class="token punctuation">(</span><span class="token class-name">AuthoritySource</span><span class="token punctuation">.</span>AUTHORITY_OUTPUT<span class="token punctuation">)</span>
	<span class="token class-name">MessageChannel</span> <span class="token function">authorityOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将信道与exchange绑定在一起，进行发送消息到channel中</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* 消息生产者
**/</span>
<span class="token annotation punctuation">@EnableBinding</span><span class="token punctuation">(</span><span class="token class-name">AuthoritySource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthorityProduce</span> <span class="token punctuation">{</span>
    <span class="token comment">// 注入自定义通道</span>
	<span class="token annotation punctuation">@Autowired</span>
	<span class="token keyword">private</span> <span class="token class-name">AuhoritySource</span> authoritySource<span class="token punctuation">;</span>
    
    <span class="token comment">// 注入默认通道</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">Source</span> source<span class="token punctuation">;</span>
    
	<span class="token comment">/**
	* 使用自定义通道发送消息
	**/</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
		authoritySource<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withPayload</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">/**
	* 使用默认通道发送消息
	**/</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        source<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">Mes</span>看   sageBuilder<span class="token punctuation">.</span><span class="token function">withPayload</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="消费者"><a href="#消费者" class="header-anchor">#</a> 消费者</h3> <div class="language- extra-class"><pre class="language-text"><code>spring:
  rabbitmq:
    host: 192.168.126.128
    port: 5672
    username: rabbit
    password: 123456
    virtual-host:
  cloud:
  	stream:
  	  bindings:
  	  	# 消息发送通道，同样也可以自定义配置通道
		input:
		  destination: stream.message # 绑定的交换机的名称
		# 自定义通道的名称 
		authorityInput: 
		  destination: stream.authority # 绑定的交换机的名称
</code></pre></div><p>自定义配置发送通道接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AuthoritySink</span><span class="token punctuation">{</span>
	<span class="token class-name">String</span> AUHORITY_INPUT <span class="token operator">=</span> <span class="token string">&quot;authorityInput&quot;</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Output</span><span class="token punctuation">(</span><span class="token class-name">AuthoritySink</span><span class="token punctuation">.</span>AUTHORITY_INPUT<span class="token punctuation">)</span>
	<span class="token class-name">SubScribableChannel</span> <span class="token function">authorityInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将消息和信道交换器进行绑定</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
*
* 自定义消息消费者
**/</span>
<span class="token annotation punctuation">@EnableBinding</span><span class="token punctuation">(</span><span class="token class-name">AuthoritySink</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageConsumer</span><span class="token punctuation">{</span>
    <span class="token comment">/**
    * 接收消息
    **/</span>
    <span class="token annotation punctuation">@StreamListener</span><span class="token punctuation">(</span><span class="token class-name">AuthoritySink</span><span class="token punctuation">.</span>AUHORITY_INPUT<span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message=&quot;</span><span class="token operator">+</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
*
* 默认消息消费者
**/</span>
<span class="token annotation punctuation">@EnableBinding</span><span class="token punctuation">(</span><span class="token class-name">Sink</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageConsumer</span><span class="token punctuation">{</span>
    <span class="token comment">/**
    * 接收消息
    **/</span>
    <span class="token annotation punctuation">@StreamListener</span><span class="token punctuation">(</span><span class="token class-name">Sink</span><span class="token punctuation">.</span>INPUT<span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message=&quot;</span><span class="token operator">+</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="消息分组"><a href="#消息分组" class="header-anchor">#</a> 消息分组</h2> <h2 id="消息分区"><a href="#消息分区" class="header-anchor">#</a> 消息分区</h2> <p>​</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue-press/guide/Spring Cloud Alibaba.html" class="prev">
        Spring Cloud Alibaba
      </a></span> <span class="next"><a href="/vue-press/guide/Spring Data.html">
        Spring Data
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/vue-press/assets/js/app.8857885a.js" defer></script><script src="/vue-press/assets/js/2.c05b7fa4.js" defer></script><script src="/vue-press/assets/js/38.f4905a78.js" defer></script>
  </body>
</html>
